<?xml version="1.0" encoding="UTF-8"?>
<!-- Spring configuration for business process engine JBoss jBPM (https://www.jboss.org/jbpm) -->
<!-- See jBPM developer guide - Chapter 17. Spring Integration -->
<!-- http://docs.jboss.com/jbpm/v4/devguide/html_single/#springIntegration -->
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

  <bean id="clientFactory" class="sernet.verinice.search.ElasticsearchClientFactory" init-method="init">
    <property name="directoryCreator" ref="directoryCreator" />
  </bean>

  <bean id="indexThread" class="sernet.verinice.search.IndexThread" scope="prototype">
    <property name="searchDao" ref="searchElementDao" />
    <property name="searchService" ref="searchService" />
    <property name="jsonBuilder" ref="jsonBuilder" />
  </bean>

  <bean id="searchIndexer" class="sernet.verinice.search.Indexer" init-method="init">
    <!-- <bean id="searchIndexer" class="sernet.verinice.search.Indexer" init-method="init"> -->
    <property name="elementDao" ref="cnaTreeElementDao" />
    <property name="indexThreadFactory">
      <bean class="org.springframework.beans.factory.config.ObjectFactoryCreatingFactoryBean">
        <property name="targetBeanName">
          <idref local="indexThread" />
        </property>
      </bean>
    </property>
    <property name="titleCache" ref="titleCache" />
  </bean>


  <bean id="searchElementDao" class="sernet.verinice.search.ElementDao">
    <property name="authService" ref="authService" />
    <property name="clientFactory" ref="clientFactory" />
    <property name="configurationService" ref="configurationService" />
  </bean>
  
  <bean id="jsonBuilder" class="sernet.verinice.search.JsonBuilder">
    <property name="titleCache" ref="titleCache" />
  </bean>

</beans>