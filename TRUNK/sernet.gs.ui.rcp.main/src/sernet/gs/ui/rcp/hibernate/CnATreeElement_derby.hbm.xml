<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="sernet.gs.ui.rcp.main.common.model">

	<class name="CnATreeElement" 
		batch-size="10"
		abstract="true">
		<id name="dbId" 
			type="java.lang.Integer" 
			column="dbId"
			unsaved-value="null">
			<generator class="native" />
		</id>
		
		<discriminator column="OBJECT_TYPE" type="string"/>	
		
		<property
			name="objectType"
			column="OBJECT_TYPE"
			insert="false"
			update="false"/>
		
		<property
			name="uuid"
		/>
		
		<set name="permissions"
			inverse="true"
			cascade="all"
			batch-size="10" >
			<key column="cte_id"/>
			<one-to-many class="Permission"/>
		</set>
		
		<many-to-one 
			name="entity"
			column="entity_id"
			class="sernet.hui.common.connect.Entity"
			cascade="all"
			fetch="join"
			/>
			
		<many-to-one 
			name="parent"
			column="parent"
			class="CnATreeElement" 	
			/>
			
		<set name="children" 
			cascade="all"
			inverse="true"
			batch-size="10"
			>
			<key column="parent" />
			<one-to-many class="CnATreeElement"/>
		</set>
		
		<set name="linksDown"
			inverse="true"
			cascade="delete,delete-orphan">
			<key column="DEPENDANT_ID"/>
			<one-to-many class="CnALink"/>
		</set>
		
		<set name="linksUp"
			inverse="true"
			cascade="delete,delete-orphan">
			<key column="DEPENDENCY_ID"/>
			<one-to-many class="CnALink"/>
		</set>
		
		
<!-- Grundschutz-Elemente: ################################################################# -->

	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.Person"
		extends="CnATreeElement"
		discriminator-value="person"/>

	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.BausteinUmsetzung"
		extends="CnATreeElement"
		discriminator-value="baustein-umsetzung"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.MassnahmenUmsetzung"
		extends="CnATreeElement"
		discriminator-value="massnahmen-umsetzung">
		
		<subclass
			name="sernet.gs.ui.rcp.main.bsi.risikoanalyse.model.RisikoMassnahmenUmsetzung"
			extends="MassnahmenUmsetzung"
			discriminator-value="risiko-massnahmen-umsetzung"/>
		
	</subclass>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.risikoanalyse.model.GefaehrdungsUmsetzung"
		extends="CnATreeElement"
		discriminator-value="gefaehrdungs-umsetzung"/>

	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.Gebaeude"
		extends="CnATreeElement"
		discriminator-value="gebaeude"/>

	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.risikoanalyse.model.FinishedRiskAnalysis"
		extends="CnATreeElement"
		discriminator-value="finished-risk-analysis"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.Anwendung"
		extends="CnATreeElement"
		discriminator-value="anwendung"/>

	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.Client"
		extends="CnATreeElement"
		discriminator-value="client"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.SonstIT"
		extends="CnATreeElement"
		discriminator-value="sonst-it"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.NetzKomponente"
		extends="CnATreeElement"
		discriminator-value="netz-komponente"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.Raum"
		extends="CnATreeElement"
		discriminator-value="raum"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.TelefonKomponente"
		extends="CnATreeElement"
		discriminator-value="telefon-komponente"/>

	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.Server"
		extends="CnATreeElement"
		discriminator-value="server"/>

	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.GebaeudeKategorie"
		extends="CnATreeElement"
		discriminator-value="gebaeude-kategorie"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.AnwendungenKategorie"
		extends="CnATreeElement"
		discriminator-value="anwendungen-kategorie"/>
		
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.ClientsKategorie"
		extends="CnATreeElement"
		discriminator-value="clients-kategorie"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.SonstigeITKategorie"
		extends="CnATreeElement"
		discriminator-value="sonstige-it-kategorie"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.NKKategorie"
		extends="CnATreeElement"
		discriminator-value="nk-kategorie"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.PersonenKategorie"
		extends="CnATreeElement"
		discriminator-value="personen-kategorie"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.RaeumeKategorie"
		extends="CnATreeElement"
		discriminator-value="raeume-kategorie"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.ServerKategorie"
		extends="CnATreeElement"
		discriminator-value="server-kategorie"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.TKKategorie"
		extends="CnATreeElement"
		discriminator-value="tk-kategorie"/>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.BSIModel"
		extends="CnATreeElement"
		discriminator-value="bsimodel">
		<property name="dbVersion"/>
	</subclass>
	
	<subclass 
		name="sernet.gs.ui.rcp.main.bsi.model.ITVerbund"
		extends="CnATreeElement"
		discriminator-value="it-verbund"/>

<!-- Datenschutz Elemente: ################################################################# -->

	<subclass 
		name="sernet.gs.ui.rcp.main.ds.model.Verarbeitungsangaben"
		extends="CnATreeElement"
		discriminator-value="verarbeitungsangaben"/>

	<subclass 
		name="sernet.gs.ui.rcp.main.ds.model.VerantwortlicheStelle"
		extends="CnATreeElement"
		discriminator-value="verantwortliche-stelle"/>

	<subclass 
		name="sernet.gs.ui.rcp.main.ds.model.Personengruppen"
		extends="CnATreeElement"
		discriminator-value="personengruppen"/>

	<subclass 
		name="sernet.gs.ui.rcp.main.ds.model.Datenverarbeitung"
		extends="CnATreeElement"
		discriminator-value="datenverarbeitung"/>

	<subclass 
		name="sernet.gs.ui.rcp.main.ds.model.StellungnahmeDSB"
		extends="CnATreeElement"
		discriminator-value="stellungnahme-dsb"/>
	
	<!-- ISO 27000 Elements -->
	
	<subclass 
		name="sernet.verinice.iso27k.model.ISO27KModel"
		extends="CnATreeElement"
		discriminator-value="iso27kmodel" />

	<subclass 
		name="sernet.verinice.iso27k.model.Organization"
		extends="CnATreeElement"
		discriminator-value="org" />
		
	<subclass 
		name="sernet.verinice.iso27k.model.AssetGroup"
		extends="CnATreeElement"
		discriminator-value="assetgroup" />
	<subclass 
		name="sernet.verinice.iso27k.model.Asset"
		extends="CnATreeElement"
		discriminator-value="asset" />
	
	<subclass 
		name="sernet.verinice.iso27k.model.ControlGroup"
		extends="CnATreeElement"
		discriminator-value="controlgroup" />
	<subclass 
		name="sernet.verinice.iso27k.model.Control"
		extends="CnATreeElement"
		discriminator-value="control" />
	
	<subclass 
		name="sernet.verinice.iso27k.model.AuditGroup"
		extends="CnATreeElement"
		discriminator-value="auditgroup" />
	<subclass 
		name="sernet.verinice.iso27k.model.Audit"
		extends="CnATreeElement"
		discriminator-value="audit" />
	
	<subclass 
		name="sernet.verinice.iso27k.model.ExceptionGroup"
		extends="CnATreeElement"
		discriminator-value="exceptiongroup" />
	<subclass 
		name="sernet.verinice.iso27k.model.Exception"
		extends="CnATreeElement"
		discriminator-value="exception" />
	
	<subclass 
		name="sernet.verinice.iso27k.model.PersonGroup"
		extends="CnATreeElement"
		discriminator-value="persongroup" />
	<subclass 
		name="sernet.verinice.iso27k.model.PersonIso"
		extends="CnATreeElement"
		discriminator-value="person-iso" />
	
	<subclass 
		name="sernet.verinice.iso27k.model.RequirementGroup"
		extends="CnATreeElement"
		discriminator-value="requirementgroup" />
	<subclass 
		name="sernet.verinice.iso27k.model.Requirement"
		extends="CnATreeElement"
		discriminator-value="requirement" />
	
	<subclass 
		name="sernet.verinice.iso27k.model.IncidentGroup"
		extends="CnATreeElement"
		discriminator-value="incidentgroup" />
	<subclass 
		name="sernet.verinice.iso27k.model.Incident"
		extends="CnATreeElement"
		discriminator-value="incident" />
		
	<subclass 
		name="sernet.verinice.iso27k.model.IncidentScenarioGroup"
		extends="CnATreeElement"
		discriminator-value="incident_scenario_group" />
	<subclass 
		name="sernet.verinice.iso27k.model.IncidentScenario"
		extends="CnATreeElement"
		discriminator-value="incident_scenario" />
		
	<subclass 
		name="sernet.verinice.iso27k.model.ResponseGroup"
		extends="CnATreeElement"
		discriminator-value="response_group" />
	<subclass 
		name="sernet.verinice.iso27k.model.Response"
		extends="CnATreeElement"
		discriminator-value="response" />
		
	<subclass 
		name="sernet.verinice.iso27k.model.ThreatGroup"
		extends="CnATreeElement"
		discriminator-value="threat_group" />
	<subclass 
		name="sernet.verinice.iso27k.model.Threat"
		extends="CnATreeElement"
		discriminator-value="threat" />
		
	<subclass 
		name="sernet.verinice.iso27k.model.VulnerabilityGroup"
		extends="CnATreeElement"
		discriminator-value="vulnerability_group" />
	<subclass 
		name="sernet.verinice.iso27k.model.Vulnerability"
		extends="CnATreeElement"
		discriminator-value="vulnerability" />
		
	<subclass 
		name="sernet.verinice.iso27k.model.DocumentGroup"
		extends="CnATreeElement"
		discriminator-value="document_group" />
	<subclass 
		name="sernet.verinice.iso27k.model.Document"
		extends="CnATreeElement"
		discriminator-value="document" />
		
	<subclass 
		name="sernet.verinice.iso27k.model.EvidenceGroup"
		extends="CnATreeElement"
		discriminator-value="evidence_group" />
	<subclass 
		name="sernet.verinice.iso27k.model.Evidence"
		extends="CnATreeElement"
		discriminator-value="evidence" />
		
	<subclass 
		name="sernet.verinice.iso27k.model.FindingGroup"
		extends="CnATreeElement"
		discriminator-value="finding_group" />
	<subclass 
		name="sernet.verinice.iso27k.model.Finding"
		extends="CnATreeElement"
		discriminator-value="finding" />
		
	<subclass 
		name="sernet.verinice.iso27k.model.InterviewGroup"
		extends="CnATreeElement"
		discriminator-value="interview_group" />
	<subclass 
		name="sernet.verinice.iso27k.model.Interview"
		extends="CnATreeElement"
		discriminator-value="interview" />
		
	<subclass 
		name="sernet.verinice.iso27k.model.ProcessGroup"
		extends="CnATreeElement"
		discriminator-value="process_group" />
	<subclass 
		name="sernet.verinice.iso27k.model.Process"
		extends="CnATreeElement"
		discriminator-value="process" />
		
	<subclass 
		name="sernet.verinice.iso27k.model.RecordGroup"
		extends="CnATreeElement"
		discriminator-value="record_group" />
	<subclass 
		name="sernet.verinice.iso27k.model.Record"
		extends="CnATreeElement"
		discriminator-value="record" />
	

	</class>
</hibernate-mapping>
